var express = require('express');
var router = express.Router();
var multer = require('multer');

const multerConfig = {

    storage: multer.diskStorage({
        //Setup where the user's file will go
        destination: function(req, file, next){
            next(null, './files');
        },

        //Then give the file a unique name
        filename: function(req, file, next){
            console.log(file);
            const ext = file.mimetype.split('/')[1];
            next(null, file.originalname);
        }
    })
};


/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { title: 'Express' });
});

router.post('/upload', multer(multerConfig).single('fileUploader'), function (req, res) {
    console.log(req.body);
    res.json({sucess: true, fileUpload: 'Complete'});
});

module.exports = router;
